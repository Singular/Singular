LIB "tst.lib";
tst_init();

// from gorzel
ring S=(0,j),(u(1..2),x(1..2),z(1..2)),dp;
minpoly=j2+1;
poly P=u(1)^4*z(1)^2-2*u(1)^3*x(1)*z(1)^2
+2*u(1)*x(1)^3*z(1)^2-x(1)^4*z(1)^2
+2*u(1)*x(1)*x(2)^2*z(1)^2
-2*x(1)^2*x(2)^2*z(1)^2-x(2)^4*z(1)^2
-4*u(1)^3*x(2)*z(1)*z(2)
+4*u(1)*x(1)^2*x(2)*z(1)*z(2)
+4*u(1)*x(2)^3*z(1)*z(2)
+u(1)^4*z(2)^2+2*u(1)^3*x(1)*z(2)^2
-2*u(1)*x(1)^3*z(2)^2-x(1)^4*z(2)^2
-2*u(1)*x(1)*x(2)^2*z(2)^2
-2*x(1)^2*x(2)^2*z(2)^2-x(2)^4*z(2)^2;

factorize(P);

// ticket #330
ring rc =(0,c),(x,y),dp;
minpoly = c2+1/4c-1/16;
poly fx = x2+(-1/4c)*x+(-1/256c+1/1024);
factorize(fx);
poly fxy = homog(fx,y);
fxy;
factorize(fxy);

//ticket #236
ring r = (0,a),(x,y),dp;
minpoly = a2+1;
poly f = (x-a)*(y-a);
factorize(f);

//ticket #89
ring ri =(0,i),(a,b,c),dp;
minpoly = i2+1;
poly f = (a+b)^2+c^2;
factorize(f);
facstd(f);
poly g = (a+c)^2+b^2;
factorize(g);
facstd(g);

//ticket #462 reported by gorzel
ring rw15 = (0,w),(x,y),dp;
minpoly = w^2-w+4;

poly f1 = 46082720409696000*x^7+(-46082720409696000*w)*x^6*y-92165440819392000*x^5*y^2+(46082720409696000*w-92165440819392000)*x^4*y^3+(46082720409696000*w+46082720409696000)*x^3*y^4+92165440819392000*x^2*y^5+(-46082720409696000*w+46082720409696000)*x*y^6-46082720409696000*y^7+(33201767234937600*w-30647785139942400)*x^5+(9771757580851200*w+100160515203724800)*x^4*y+(-44639165312524800*w+72399840258124800)*x^3*y^2+(-50857556500339200*w+8661330583027200)*x^2*y^3+(-9771757580851200*w-100160515203724800)*x*y^4+(33645938034067200*w-26095034448864000)*y^5+(-27845878235380000*w-122690040515260000)*x^4+(118340445370520000*w-78316910631160000)*x^3*y+(49599903465540000*w+143572936815180000)*x^2*y^2+(-68740541904980000*w+221889847446340000)*x*y^3+(-46553976962930000*w-92669364707510000)*y^4+(-10245093811971840*w-22646289009116160)*x^3+(13836455538428160*w-45510917399009280)*x^2*y+(23501184011055360*w-81074549479680)*x*y^2+(1628715454398720*w+33167517920305920)*y^3+(-39904964412744000*w+71294643532392000)*x^2+(-33810691604940000*w-61360144023780000)*x*y+(33142826091756000*w-83566672337148000)*y^2+(31945832606457089*w+80538751785644435)*x+(-60831105992681752*w+16100113835778104)*y+(6386463969822000*w+7137812672154000);

poly f2 = 2294919476402860800*x^8+(2294919476402860800*w)*x^7*y+(2294919476402860800*w-4589838952805721600)*x^6*y^2-4589838952805721600*x^5*y^3-2294919476402860800*x^4*y^4-4589838952805721600*x^3*y^5+(-2294919476402860800*w-2294919476402860800)*x^2*y^6+(-2294919476402860800*w+2294919476402860800)*x*y^7+2294919476402860800*y^8+(2079252344885483520*w+199077352169886720)*x^6+(1664507861198219520*w-6691211003487859200)*x^5*y+(-940087496357798400*w-4357582041940853760)*x^4*y^2+(-132718234779924480*w-1360361906494225920)*x^3*y^3+(11059852898327040*w-5164951303518727680)*x^2*y^4+(-2615655210454344960*w-3058049326387426560)*x*y^5+(-1725337052139018240*w+3428554398481382400)*y^6+(-303374279659956000*w-5069995781923932000)*x^5+(-3770035487253912000*w-433219676416104000)*x^4*y+(-4550011664055924000*w+3596807869771812000)*x^3*y^2+(-2903294868999996000*w+8363429372035788000)*x^2*y^3+(-888281095906038000*w+7908367952545854000)*x*y^4+(2166700912923936000*w+2079936471472032000)*y^5+(423632341377847296*w-2525937150738157056)*x^4+(-1427080802231483136*w+208937943910563840)*x^3*y+(233775974997891072*w+1098882998754621696)*x^2*y^2+(909106583118508800*w-2643717921543353088)*x*y^3+(-1102041053136433152*w-662978218196823552)*y^4+(-2937940392496416000*w-2605343366930784000)*x^3+(-4025809830284004000*w+6326272590446292000)*x^2*y+(-2903294868999996000*w+8363429372035788000)*x*y^2+(1552119452639616000*w+5543283759427200000)*y^3+(-15951155173959635*w+2981235020448425687)*x^2+(1622440449955667768*w+1652892262372213288)*x*y+(1685231063399012416*w-2263997141199178816)*y^2+(-1166168320889497200*w+991554882467540400)*x+2294919476402860800*y+(941170437657378096*w+239157859721078160);

factorize (f1*f2);

ring rw =(0,w),(x,y),dp;
minpoly = w4-w3+2w2+w+1;
poly f = x15-y15-15*x13+15*y13+90*x11-90*y11-275*x9+275*y9+450*x7-450*y7-378*x5+378*y5+140*x3-140*y3-15*x+15*y;
factorize(f);

kill r;
ring r= (0,a),(x,y,z,s),dp;
minpoly= a2+1;
poly f= 8730/37*a*x^5*y^14*z^5*s^5+17460/37*a*x^8*y^11*z^5*s^5+8730/37*a*x^11*y^8*z^5*s^5+4860/37*x^4*y^13*z^4*s^5+9720/37*x^7*y^10*z^4*s^5+4860/37*x^10*y^7*z^4*s^5-4559/48*a*x^4*y^13*z^5*s^4-4559/24*a*x^7*y^10*z^5*s^4-4559/48*a*x^10*y^7*z^5*s^4-423/8*x^3*y^12*z^4*s^4-423/4*x^6*y^9*z^4*s^4-423/8*x^9*y^6*z^4*s^4-9000/37*a*x^7*y^11*z^2*s^4-18000/37*a*x^10*y^8*z^2*s^4-9000/37*a*x^13*y^5*z^2*s^4-3492/49*a*x^5*y^15*z^5*s^3-3783/28*a*x^6*y^14*z^5*s^3-7081/37*x^6*y^14*z^5*s^3-6984/49*a*x^8*y^12*z^5*s^3-3783/14*a*x^9*y^11*z^5*s^3-14162/37*x^9*y^11*z^5*s^3-3492/49*a*x^11*y^9*z^5*s^3-3783/28*a*x^12*y^8*z^5*s^3-7081/37*x^12*y^8*z^5*s^3+2716/23*a*x^5*y^14*z^4*s^3-1944/49*x^4*y^14*z^4*s^3+3942/37*a*x^5*y^13*z^4*s^3-1053/14*x^5*y^13*z^4*s^3+5432/23*a*x^8*y^11*z^4*s^3-3888/49*x^7*y^11*z^4*s^3+7884/37*a*x^8*y^10*z^4*s^3-1053/7*x^8*y^10*z^4*s^3+2716/23*a*x^11*y^8*z^4*s^3-1944/49*x^10*y^8*z^4*s^3+3942/37*a*x^11*y^7*z^4*s^3-1053/14*x^11*y^7*z^4*s^3+1512/23*x^4*y^13*z^3*s^3+3024/23*x^7*y^10*z^3*s^3+1512/23*x^10*y^7*z^3*s^3+1175/12*a*x^6*y^10*z^2*s^3-2070/37*a*x^9*y^9*z^2*s^3+1175/6*a*x^9*y^7*z^2*s^3-4140/37*a*x^12*y^6*z^2*s^3+1175/12*a*x^12*y^4*z^2*s^3-2070/37*a*x^15*y^3*z^2*s^3-5940/37*a*x^5*y^10*z*s^3-11880/37*a*x^8*y^7*z*s^3-5940/37*a*x^11*y^4*z*s^3-6120/37*x^7*y^11*z^4*s^2-12240/37*x^10*y^8*z^4*s^2-6120/37*x^13*y^5*z^4*s^2+3600/49*a*x^7*y^12*z^2*s^2+975/7*a*x^8*y^11*z^2*s^2+7300/37*x^8*y^11*z^2*s^2+7200/49*a*x^10*y^9*z^2*s^2+1950/7*a*x^11*y^8*z^2*s^2+14600/37*x^11*y^8*z^2*s^2+1081/48*a*x^8*y^8*z^2*s^2+3600/49*a*x^13*y^6*z^2*s^2+975/7*a*x^14*y^5*z^2*s^2+7300/37*x^14*y^5*z^2*s^2+1081/24*a*x^11*y^5*z^2*s^2+1081/48*a*x^14*y^2*z^2*s^2-2800/23*a*x^7*y^11*z*s^2+517/8*a*x^4*y^9*z*s^2-5600/23*a*x^10*y^8*z*s^2+517/4*a*x^7*y^6*z*s^2-2800/23*a*x^13*y^5*z*s^2+517/8*a*x^10*y^3*z*s^2+799/12*x^6*y^10*z^4*s+799/6*x^9*y^7*z^4*s+799/12*x^12*y^4*z^4*s+828/49*a*x^9*y^10*z^2*s+897/28*a*x^10*y^9*z^2*s+1679/37*x^10*y^9*z^2*s+1656/49*a*x^12*y^7*z^2*s+897/14*a*x^13*y^6*z^2*s+3358/37*x^13*y^6*z^2*s+828/49*a*x^15*y^4*z^2*s+897/28*a*x^16*y^3*z^2*s+1679/37*x^16*y^3*z^2*s+2376/49*a*x^5*y^11*z*s+1287/14*a*x^6*y^10*z*s+4818/37*x^6*y^10*z*s-28*a*x^9*y^9*z*s+4752/49*a*x^8*y^8*z*s+1287/7*a*x^9*y^7*z*s+9636/37*x^9*y^7*z*s-56*a*x^12*y^6*z*s+2376/49*a*x^11*y^5*z*s+1287/14*a*x^12*y^4*z*s+4818/37*x^12*y^4*z*s-28*a*x^15*y^3*z*s-1848/23*a*x^5*y^10*s-3696/23*a*x^8*y^7*s-1848/23*a*x^11*y^4*s+2448/49*x^7*y^12*z^4-4964/37*a*x^8*y^11*z^4+663/7*x^8*y^11*z^4+4896/49*x^10*y^9*z^4-9928/37*a*x^11*y^8*z^4+1326/7*x^11*y^8*z^4+2448/49*x^13*y^6*z^4-4964/37*a*x^14*y^5*z^4+663/7*x^14*y^5*z^4-1904/23*x^7*y^11*z^3-3808/23*x^10*y^8*z^3-1904/23*x^13*y^5*z^3;
f= f*f;
factorize (f);

kill r;
ring r=(0,a),x,dp;
minpoly= 439239619*a^8-5632;
factorize (169*a^2*x^2+52*a*x+8);

tst_status(1); $
