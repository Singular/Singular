LIB "tst.lib";
tst_init();

proc testfactors (list l, poly f)
{
  poly g= 1;
  for (int i= 1; i <= size (l[1]); i++)
  {
    g= g*(l[1][i]^l[2][i]);
  }
  g == f;
  l;
}

ring r=(0,a),(x,y),lp;
minpoly= 1000*a8+a5+233*a+1;

list l;
poly g= (-106671/379000000a5+24854343/379000a4+106671/379000a3-24854343/379000000a-106671/379000000)*(x4y7+(17872400039344000/999a7-76705579568000/999a6+329208496000/999a5+17870987127344/999a4-76699515568/999a3+329208496/999a2-1412912/999a+462696578797024/111))*(x6y2+(-228/961a2)*x5y8+(295976258105814000/961a7-1270284369551000/961a6+5451864247000/961a5+9546866436994/31a4-1270183946551/961a3+5451433247/961a2-23398559/961a+2224595746411451/31)*x4y8+(797000/961a7+797/961a4+185701/961)*x4y3-642/961*x3y3+(-100/961a3)*x3y2+(-753/961a2)*x3y+(-171954000/961a7+738000/961a6-171954/961a4+738/961a3-40065282/961)*x-831/961*y2)*(x+y)^2*(x2-xy+y2)^2*y^5*x^10;

l= factorize (g); testfactors (l,g);

poly f= (77/108000a6-17941/108a5-77/108a4+17941/108000a2+77/108000a)*(x11y6+(-27/192500a7-27/192500000000a6+6291/96250000a5+27/192500000a4-6291/192500000000a2+1465802973/192500000000a+6291/192500000))*(x19y8+(-11420770143875a7+49016180875a6-210369875a5-91358938151/8a4+392098447/8a3-1682959/8a2+7223/8a-10644157774107/4)*x18y18+(1140a7+57/50a4+13281/50)*x18y9+(-13/25a7+431/200a)*x17y19+(-50407607945a7+216341665a6-928505a5-10080724589/200a4+43268333/200a3-185701/200a2+797/200a-2348994530237/200)*x17y4+(-369/100a5)*x14y+(-831/200a7)*x13y3+(-41/25a3)*x10y13+(161/40a)*x10y3+(961/200a7)*x9y3+(-854966221210530a7+3669382923645a6-15748424565a5-85489863140553/100a4+733818567729/200a3-3149435913/200a2+13517961/200a-7968285181693743/40)*x8y15+(6384614902795584474915a7-27401780698653596340a6+117604209006925725a5+1276822032740226976983/200a4-1369980721822283067/50a3+4703796469769229/40a2-50469919203459/100a+148761527235353727360813/100)*x8-377/200*x7y8+(174267690a7-747930a6+3210a5+17426769/100a4-74793/100a3+321/100a2+4060437177/100)*x6y4+(1/2000a7+233/2000a3+1/2000a2)*x6y3+(753/200000a6+175449/200000a2+753/200000a)*x6y2+(253/200a2)*x4y9+(358412827449678400a7-1538252478322560a6+6601941967040a5+1791922464673992/5a4-38453271774064/25a3+165035501176/25a2-708306872/25a+2087754719897416864/25)*xy15+(443/100a7)*y9)*(x+y)^2*(x2-xy+y2)^2*x^5*y^5;

l= factorize (f); testfactors (l,f);

//tr. #462 by gorzel
ring rw13 = (0,w),(T,x,y),dp; 
minpoly = (w^4-w^3+2*w^2+4*w+3);

poly Hneu = 
x^13-y^13+(-65*w^3+117*w^2-208*w-156)*T*x^11+(65*w^3-91*w^2+143*w+234)*T*y^11+(-39*w^3+117*w^2-234*w+117)*T*x^10+(78*w^3-91*w^2+130*w+390)*T*y^10+(-689*w^3-2171*w^2+5746*w-16107)*T^2*x^9+(-16705/3*w^3+32435/3*w^2-58045/3*w-8788)*T^2*y^9+(-15210*w^3+21606*w^2-34476*w-57798)*T^2*x^8+(-16614*w^3+28002*w^2-47892*w-43992)*T^2*y^8+(-14547*w^3+26052*w^2-45435*w-32058)*T^2*x^7+(-15054*w^3+24882*w^2-42237*w-42120)*T^2*y^7+(308581*w^3-505388*w^2+854893*w+883038)*T^3*x^7+(47242*w^3-237302*w^2+499135*w-553488)*T^3*y^7+(452270*w^3-1191463*w^2+2291003*w-644709)*T^3*x^6+(582439*w^3-1362920*w^2+2555917*w-92508)*T^3*y^6+(-270816*w^3-229515*w^2+799266*w-3670641)*T^3*x^5+(883662*w^3-1973829*w^2+3661710*w+262431)*T^3*y^5+(-4396327/3*w^3+19510634/3*w^2-40530178/3*w+13462280)*T^4*x^5+(5640596*w^3-6386068*w^2+9065030*w+28409901)*T^4*y^5+(-830401*w^3+974207*w^2-1412983*w-4036071)*T^3*x^4+(760643*w^3-1689688*w^2+3130322*w+266370)*T^3*y^4+(20294378*w^3-26643448*w^2+41060318*w+86440380)*T^4*x^4+(5279066*w^3+3610412*w^2-13593424*w+67843698)*T^4*y^4+(34683727*w^3-58690697*w^2+100467835*w+91123968)*T^4*x^3+(6227858*w^3+7596407*w^2-23720320*w+94392402)*T^4*y^3+(-269815676/3*w^3+390512551/3*w^2-629448482/3*w-331043258)*T^5*x^3+(-94859661*w^3+166063209*w^2-287546493*w-225369144)*T^5*y^3+(31413330*w^3-69137640*w^2+127795122*w+13769730)*T^4*x^2+(2733874*w^3+19260358*w^2-47086208*w+109961202)*T^4*y^2+(-421494307/3*w^3+945300395/3*w^2-1755321490/3*w-36293842)*T^5*x^2+(-193843104*w^3+274995669*w^2-439410660*w-737414028)*T^5*y^2+(6677424*w^3-25392744*w^2+51796368*w-43097184)*T^4*x+(4253080*w^3+7591792*w^2-21735272*w+74806680)*T^4*y+(-52820170*w^3+190018127*w^2-384748741*w+294246537)*T^5*x+(-196474785*w^3+296309208*w^2-485858373*w-671785452)*T^5*y+(5248218976/27*w^3-12863190080/27*w^2+24372820576/27*w-1115453924/9)*T^6*x+(136336200*w^3-396591312*w^2+776924772*w-355580316)*T^6*y+(-153999872/3*w^3+341724448/3*w^2-632914880/3*w-18505760)*T^5+(196115972/3*w^3-887376100/3*w^2+1847311544/3*w-624999544)*T^6;


int bugcnt,i;
for (i=1;i<=50;i++) 
{
  i;
  if (size(factorize(Hneu,1))<2) { "failed";bugcnt++;}
}
if (bugcnt) { "Bug with factorize: ",bugcnt,"% wrong";} else { "OK"; }

for (i=1;i<=50;i++) 
{ 
  i;
  if (size(factorize(subst(Hneu,x,3*x,y,3*y)/bigint(3)^13,1))<2) { "failed";bugcnt++;}
}
if (bugcnt) { "Bug with factorize: ",bugcnt,"% wrong";} else { "OK"; }

for (i=1;i<=50;i++) 
{ 
  i;
  if (size(factorize(subst(Hneu,x,1/3*x,y,1/3*y)*bigint(3)^13,1))<2) { "failed";bugcnt++;}
}
if (bugcnt) { "Bug with factorize: ",bugcnt,"% wrong";} else { "OK"; }

tst_status(1); $
